Идеи решения:
1) Натренировать нейронку/xgboost
2) Волновой алгоритм на графах
3) Прямой перебор(на его основе можно результаты синтетических данных получать)